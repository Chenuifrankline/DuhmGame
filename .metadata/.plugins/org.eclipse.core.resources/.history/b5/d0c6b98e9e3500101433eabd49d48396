package codegenerator.templates

import codegenerator.CodegenInterface

import codegenerator.Template
import org.eclipse.uml2.uml.AggregationKind
import org.eclipse.uml2.uml.Property
import javax.lang.model.type.PrimitiveType

class PropertyTemplate implements Template<Property> {
	
override generateCode(CodegenInterface it, Property umlProperty, String context) {

    var name = umlProperty.name
    var pointer = ""
    var upper = ""

    if (umlProperty.upper > 1) {
        upper = "[" + umlProperty.upper.toString + "]"
    } else if (umlProperty.upper == -1) {
        pointer = "*"
    }

    // Prüfen, ob Typ null ist
    if (umlProperty.type === null) {
        // Warnung ausgeben oder Ersatzwert verwenden
        System.err.println("WARNUNG: Property '" + name + "' hat keinen Typ.")
        return "// Fehler: Property '" + name + "' hat keinen Typ.\n"
    }

    var type = generate(umlProperty.type, "type")

    if (!(umlProperty.type instanceof PrimitiveType) &&
        umlProperty.aggregation == AggregationKind.COMPOSITE_LITERAL) {

        return '''«umlProperty.type.name» «name»«upper»;'''
    } else {
        return '''«type»«pointer» «name»«upper»;'''
    }
}
}